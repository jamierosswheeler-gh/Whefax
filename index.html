<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>WHEFAX HOLIDAYS</title>

<link rel="stylesheet" href="styles.css?v=10">
<link rel="manifest" href="manifest.json">
<link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
<link rel="apple-touch-icon" href="assets/favicon.png">

<script src="backend.js?v=10" defer></script>
<script src="user.js?v=10" defer></script>
</head>

<body class="tab-deals">

<!-- Ticker -->
<div class="ticker-bar top">
  <div class="left">WHEFAX HOLIDAYS</div>
  <div class="right ticker-time"></div>
</div>
<script>
(function(){
  function s(n){const x=["th","st","nd","rd"],v=n%100;return n+(x[(v-20)%10]||x[v]||x[0]);}
  const dA=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],mA=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
  function tick(){
    const e=document.querySelector(".ticker-time");if(!e)return;
    const a=new Date; e.textContent=dA[a.getDay()]+" "+s(a.getDate())+" "+mA[a.getMonth()]+" "+("0"+a.getHours()).slice(-2)+":"+("0"+a.getMinutes()).slice(-2)+":"+("0"+a.getSeconds()).slice(-2);
  }
  setInterval(tick,1000);tick();
})();
</script>

<!-- Header -->
<header class="hero hero--ratio-5x1">
  <img src="assets/header.svg?v=10" alt="WHEFAX header">
</header>

<!-- Top navigation -->
<nav class="topnav">
  <a href="index.html" class="toptab red">DEALS</a>
  <a href="request.html" class="toptab green">REQUEST</a>
  <a href="blog.html" class="toptab yellow">BLOG</a>
  <a href="about.html" class="toptab blue">ABOUT</a>
</nav>

<main id="deal_container">
  <div class="filters" id="filter_wrap"></div>
  <div id="deals_list">Loading dealsâ€¦</div>
</main>

<div class="kay-banner">
  <a href="https://youtu.be/xfXg5BGXw-w?si=LDGyP963HvJO3dQd" target="_blank">
    WHEFAX HOLIDAYS<br>BOOK IT. PACK IT. F##K OFF.
  </a>
  <button id="installAppBtn" class="btn blue small">WHEFAX APP</button>
</div>

<div class="bottom-links">
  <a href="index.html" class="navlink red">DEALS</a>
  <a href="request.html" class="navlink green">REQUEST</a>
  <a href="blog.html" class="navlink yellow">BLOG</a>
  <a href="about.html" class="navlink blue">ABOUT</a>
</div>

<script>
// Smart PWA install system
let deferredPrompt;
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js');
}
window.addEventListener('beforeinstallprompt', e => {
  e.preventDefault(); deferredPrompt = e;
  if (!localStorage.getItem('whefax.pwaPrompted')) {
    setTimeout(() => {
      if (confirm("ðŸ“º Add WHEFAX HOLIDAYS to your home screen?")) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then(c => {
          if (c.outcome === 'accepted') console.log('Installed!');
          localStorage.setItem('whefax.pwaPrompted', 'yes');
        });
      }
    }, 4000);
  }
});
document.addEventListener('click', e => {
  if (e.target && e.target.id === 'installAppBtn' && deferredPrompt) {
    deferredPrompt.prompt();
    deferredPrompt.userChoice.then(c => {
      if (c.outcome === 'accepted') console.log('Installed!');
      localStorage.setItem('whefax.pwaPrompted','yes');
    });
  }
});
</script>

</body>
</html>
